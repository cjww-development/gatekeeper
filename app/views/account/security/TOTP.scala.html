@import controllers.ui.{routes => uiRoutes}
@import views.html.Main
@import views.html.components.forms.TextInput
@import views.AuthForView
@import helper._


@(form: Form[TotpSetupCodes], qrDataUri: String)(implicit rh: RequestHeader, msgs: MessagesApi, lang: Lang)

@Main("Enabling two factor authentication", AuthForView.isAuthenticated(rh), AuthForView.isOrgUser(rh)) {
    <img class="mb-4" src="@routes.Assets.at("images/logo.png")" alt="" height="72">
    <h1 class="h3 mb-3 font-weight-normal">Enable two factor authentication</h1>

    <hr>

    <div class="card">
        <div class="card-body">
            <h5 class="card-title">Scan your code</h5>
            <p class="default-text">Scan this code with your phones camera to receive codes in Google Authenticator</p>
            <img src="@qrDataUri" width="100%">

            <p class="default-text">Enter the next two codes generated by Google Authenticator, below</p>

            <form action="@uiRoutes.AccountController.postTotpSetupVerification()" method="post">
                @CSRF.formField

                @TextInput(
                    form("codeOne"),
                    isReadOnly = false,
                    Symbol("_id") -> "codeOneInput",
                    Symbol("_name") -> "codeOne",
                    Symbol("_label") -> "Code one",
                    Symbol("_type") -> "text",
                    Symbol("_class") -> "form-control form-input-topper"
                )

                @TextInput(
                    form("codeTwo"),
                    isReadOnly = false,
                    Symbol("_id") -> "codeTwoInput",
                    Symbol("_name") -> "codeTwo",
                    Symbol("_label") -> "Code two",
                    Symbol("_type") -> "text",
                    Symbol("_class") -> "form-control form-input-bottom"
                )

                <hr>

                <button class="btn btn-lg btn-success btn-block" id="verify-code-submit" type="submit">Verify codes</button>
            </form>
        </div>
    </div>
}
